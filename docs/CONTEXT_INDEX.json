{
  "metadata": {
    "id": "soundspan-agent-context-index",
    "version": "2026-02-19.01",
    "description": "Machine-readable index for startup context retrieval and split-doc drift checks."
  },
  "startupReadOrder": [
    "AGENTS.md",
    "docs/AGENT_RULES.md",
    "docs/CONTEXT_INDEX.json",
    "docs/AGENT_CONTEXT.md",
    ".agents/EXECUTION_QUEUE.json",
    ".agents/CONTINUITY.md"
  ],
  "primaryContracts": {
    "bootstrapFile": "AGENTS.md",
    "rulesFile": "docs/AGENT_RULES.md",
    "contextFile": "docs/AGENT_CONTEXT.md",
    "policyFile": ".github/policies/agent-governance.json",
    "enforcerFile": ".github/scripts/enforce-agent-policies.mjs",
    "preflightFile": ".github/scripts/agent-session-preflight.mjs"
  },
  "sessionArtifacts": {
    "executionQueueFile": ".agents/EXECUTION_QUEUE.json",
    "continuityFile": ".agents/CONTINUITY.md",
    "sessionBriefJsonFile": ".agents/SESSION_BRIEF.json",
    "archiveRoot": ".agents/archives",
    "archiveIndexFile": ".agents/EXECUTION_ARCHIVE_INDEX.json",
    "archiveShardBy": "feature_id",
    "archiveFormat": "jsonl",
    "archiveReadPolicy": "cold_lookup_only",
    "retiredArtifacts": [
      ".agents/ACTIVE_SCOPE.json",
      ".agents/UNRESOLVED_QUEUE.json"
    ],
    "queueScopedRead": {
      "requiredTopLevelFields": [
        "state",
        "feature_id",
        "task_id",
        "objective",
        "last_updated",
        "updated_at",
        "in_scope",
        "out_of_scope",
        "open_questions"
      ],
      "itemSelectorFields": [
        "id",
        "plan_ref",
        "owner",
        "depends_on"
      ],
      "maxItemsPerRead": 25
    },
    "archiveOnComplete": {
      "itemStates": [
        "complete"
      ],
      "queueStates": [
        "complete"
      ],
      "forbidCompleteInHotQueue": true
    },
    "plansRoot": ".agents/plans",
    "planRoots": [
      ".agents/plans/current",
      ".agents/plans/deferred",
      ".agents/plans/archived"
    ],
    "planQueueSync": {
      "enabled": true,
      "planFileName": "PLAN.md",
      "roots": [
        ".agents/plans/current",
        ".agents/plans/deferred"
      ],
      "stateByRoot": {
        ".agents/plans/current": "pending",
        ".agents/plans/deferred": "deferred"
      }
    },
    "archivedPlanSync": {
      "enabled": true,
      "root": ".agents/plans/archived",
      "planFileName": "PLAN.md",
      "archiveKeyPrefix": "feature-plan:",
      "indexKind": "feature"
    },
    "stalePlanReferenceCheck": {
      "enabled": true,
      "failureMode": "fail",
      "scanRoots": [
        ".agents/plans"
      ]
    },
    "repositoryIndexPreflight": {
      "enabled": true,
      "buildIfMissing": true,
      "reindexBeforeVerify": true,
      "verifyStrict": true,
      "failureMode": "fail",
      "closeoutVerifyIfPossible": true
    },
    "workspaceLayout": {
      "canonicalRepoRoot": "/home/joshd/git/soundspan",
      "canonicalAgentsRoot": "/home/joshd/git/soundspan/.agents",
      "worktreesRoot": "/home/joshd/git/soundspan/.worktrees",
      "semanticMergeRequired": true,
      "worktreeAgentsSymlinkRequired": true
    },
    "sessionBriefContract": {
      "requiredFields": [
        "generated_at",
        "policy",
        "scope",
        "queue_file",
        "archive_index_file",
        "index_readiness",
        "queue_read_contract",
        "queue_overview",
        "next_actions"
      ],
      "freshnessHoursWarning": 24,
      "freshnessFailureMode": "fail"
    }
  },
  "ruleCatalog": {
    "file": "docs/AGENT_RULES.md",
    "section": "## Rule ID Catalog (Machine Cross-Reference)"
  },
  "rulesSections": [
    {
      "id": "rules_global_agreements",
      "file": "docs/AGENT_RULES.md",
      "heading": "## Global Operating Agreements (All LLMs)"
    },
    {
      "id": "rules_orchestrator_contract",
      "file": "docs/AGENT_RULES.md",
      "heading": "### Orchestrator/Subagent Instruction Contract (Required)"
    },
    {
      "id": "rules_continuity",
      "file": "docs/AGENT_RULES.md",
      "heading": "### CONTINUITY.md Contract (Required)"
    },
    {
      "id": "rules_post_compaction",
      "file": "docs/AGENT_RULES.md",
      "heading": "### Post-Compaction Startup Checklist (Required)"
    },
    {
      "id": "rules_definition_of_done",
      "file": "docs/AGENT_RULES.md",
      "heading": "### Definition of Done"
    }
  ],
  "contextSections": [
    {
      "id": "context_project_overview",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Project Overview"
    },
    {
      "id": "context_architecture",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Architecture"
    },
    {
      "id": "context_tech_stack",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Tech Stack"
    },
    {
      "id": "context_project_structure",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Project Structure"
    },
    {
      "id": "context_key_conventions",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Key Conventions"
    },
    {
      "id": "context_reuse_atlas",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Reuse and Consolidation Atlas"
    },
    {
      "id": "context_fork_docs",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Fork Documentation Maintenance"
    },
    {
      "id": "context_full_stack_gates",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Full-Stack Delivery Gates"
    },
    {
      "id": "context_database",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Database"
    },
    {
      "id": "context_streaming_integration",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Streaming Integration"
    },
    {
      "id": "context_testing",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Testing"
    },
    {
      "id": "context_local_testing_bootstrap",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Local Testing Bootstrap"
    },
    {
      "id": "context_common_tasks",
      "file": "docs/AGENT_CONTEXT.md",
      "heading": "## Common Tasks"
    }
  ],
  "commands": {
    "policyCheck": "node .github/scripts/enforce-agent-policies.mjs",
    "sessionPreflight": "npm run agent:preflight",
    "queueLifecycle": "npm run agent:queue:open -- --help",
    "indexBuild": "npm run index:build",
    "indexVerify": "npm run index:verify",
    "indexQueryStrictFresh": "node tools/index/indexer.mjs query \"<query>\" --strict-fresh"
  }
}
